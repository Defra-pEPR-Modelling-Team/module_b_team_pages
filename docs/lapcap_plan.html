<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>LAPCAP Plan</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
  <link rel="icon" type="image/png" href="favicon.ico"/>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="notitle.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">FPC Team Pages</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    New Starters
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="new_induction_stuff.html">Start here!</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">How to...</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="new_how_to_access_r_studio.html">...access R Studio</a>
        </li>
        <li>
          <a href="new_how_to_set_up_github.html">...set up Github</a>
        </li>
        <li>
          <a href="new_how_to_edit_github_code.html">...edit Github code</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li>
  <a href="lapcap_library.html">LAPCAP Library</a>
</li>
<li>
  <a href="lapcap_plan.html">LAPCAP Plan</a>
</li>
<li>
  <a href="lapcap_handbook.html">LAPCAP Handbook</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Useful Bits
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="other_data_dictionary.html">Data Dictionary</a>
    </li>
    <li>
      <a href="other_glossary.html">Glossary</a>
    </li>
    <li>
      <a href="other_learning.html">Learning and Development</a>
    </li>
    <li>
      <a href="other_meeting_etiquette.html">Meeting Etiquette</a>
    </li>
    <li>
      <a href="other_common_problems.html">Common Problems</a>
    </li>
    <li>
      <a href="other_useful_links.html">Collected Links</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">LAPCAP Plan</h1>

</div>


<div id="lapcap-plan" class="section level1">
<h1>LAPCAP Plan</h1>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Extended Producer Responsibility for packaging (pEPR) will move the
full cost of dealing with packaging waste from households away from
local taxpayers and councils to the packaging producers (applying the
‘polluter pays principle’), giving producers responsibility for the
costs of their packaging throughout its life cycle. This will encourage
producers to reduce their use of packaging and use packaging which is
easier to recycle. Producers will pay more for less sustainable
packaging, incentivising packaging that uses less material and is easier
to recycle. Producers will also be expected to meet ambitious new
recycling targets and use clear unambiguous labelling of recyclability
to make it easy for consumers to do the right thing.</p>
<p>pEPR will be introduced in a phased manner from 2025, initially
focussing on payments for household packaging waste managed by local
authorities, with such payments being determined from 1 April 2025.
While waste management is a devolved policy area, the pEPR scheme will
be implemented simultaneously in England, Wales, Scotland and Northern
Ireland and administered by a single scheme administrator, hosted by
Defra (the UK government Department for the Environment Food and Rural
Affairs), known as PackUK.</p>
<p>The LAPCAP (Local Authority Packaging Cost And Performance) Model
will be used to calculate the Basic Payment Amount paid to each Local
Authority from 1 April 2025 for the collection and disposal of household
packaging waste (excluding street bins and litter). The model will also
be used to calculate the total cost for each packaging material, which
will be divided between those producers who are obligated under the
scheme.</p>
<p>The LAPCAP model is being developed by a team within Defra, but
requires approval by all 4 participating nations. PackUK (whose
governance includes all 4 UK nations) has the responsibility to approve
the modelling approach. Prior to establishment on PackUK the 4-nation
CPR Programme Board stood in to govern the model.</p>
<p>This document details the background, theory and plan for model
development, quality assurance and signoff processes of LAPCAP. It
includes detail on how, when and by whom model, data or assumption
changes will be assured. This includes a list of responsibilities
relating to the model, who the model owner is, the governance structure
and decision-making process supporting the model.</p>
<p>The LAPCAP handbook gives practical steps and detail for how this
will be achieved and should be used by FPC team members to carry out the
processes correctly.</p>
</div>
<div id="is-lapcap-business-critical" class="section level2">
<h2>Is LAPCAP Business Critical?</h2>
<p>The <a
href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/206946/review_of_qa_of_govt_analytical_models_final_report_040313.pdf">Macpherson
Review</a> assesses business criticality on the basis of “the extent to
which error could lead to serious financial, legal or reputational
damage”. An assessment of this is shown below.</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Risks</strong></td>
<td><strong>Example/explanation</strong></td>
<td><strong>Risk rating</strong></td>
</tr>
<tr class="even">
<td>Financial</td>
<td>The model will be used to determine fees and payments of over £1
billion.</td>
<td>High</td>
</tr>
<tr class="odd">
<td>Legal</td>
<td>There is a strong chance that stakeholders could challenge the fees
or payments.</td>
<td>High</td>
</tr>
<tr class="even">
<td>Reputational</td>
<td>This is a high profile scheme and its failure would lead to
criticism of DEFRA and government.</td>
<td>High</td>
</tr>
</tbody>
</table>
<p>This model is high risk in all of these categories, hence
<strong>should be considered business critical</strong>. It is also
highly complex, relying on many data sources and assumptions. As a
result it merits QA at the upper end of robustness.</p>
</div>
<div id="risks" class="section level2">
<h2>Risks</h2>
<p>Decision-makers need information on the uncertainty of decision
outcomes i.e. the range of outcomes that may occur and their relative
likelihoods; in order to act appropriately and be confident with the
messages they communicate. The model risk log identifies these more
detailed risks and proposed mitigations. It can be accessed here: <a
href="https://defra.sharepoint.com/:x:/r/teams/Team1478/Extended%20Producer%20Responsibility%20for%20Packaging/07%20Fees%20and%20Payments%20Calculator/18%20Module%20B1%20-%20LA%20FNCs/16%20QA/Risk%20Registers/Risk%20register%20v2.0.xlsm?d=wbb875e70cabb402fa21468433ffb4caf&amp;csf=1&amp;web=1&amp;e=LrpVtg">Risk
register v2.0.xlsm</a>, and is maintained by David Akpan through monthly
reviews with the FPC G7 lead analysts.</p>
</div>
<div id="stakeholder-groups" class="section level2">
<h2>Stakeholder Groups</h2>
<p>A large number of stakeholders are involved in quality assurance of
the LAPCAP model. We have split the roles into “signatory” roles which
are directly responsible or accountable for producing or approving the
model, and “consultative” roles who provide advice or evidence which
could improve the model.</p>
<div id="signatory-roles" class="section level3">
<h3>Signatory Roles</h3>
<p>These are laid out below in hierarchical order:</p>
<ul>
<li><p><strong>Accounting Officers</strong> of the 4 nations (Defra
permanent secretary and equivalents in devolved administrations)</p>
<ul>
<li>These individuals may be required to agree to any financial risks
arising from the modelling</li>
</ul></li>
<li><p><strong>Senior Responsible Officers (SROs)</strong> are the
members of the PackUK Executive Committee</p>
<ul>
<li>The joint SROs fulfil the “Commissioner” role in the Aqua book
terminology and are responsible for ensuring that the model is fit for
purpose, based on the quality assurance advice they receive.</li>
<li>Previously this was fulfilled by members of pEPR Project Board,
specifically Director of Resources &amp; Waste (Emma Bourne) and
equivalents in the Devolved Administrations (David McPhee, Rhodri Asby,
Shane Doris).</li>
</ul></li>
<li><p><strong>Analytical Board</strong></p>
<ul>
<li>The pEPR Project Board requested the formation of a 4-nation pEPR
Analytical Board to scrutinise the model as it is developed, and to
advise the SROs on the quality of the model before formal approval of
the model for use. At time of writing the pEPR Analytical Board consists
of senior analysts from England, Wales and Scotland, with Northern
Ireland content to rely on the analysts from these three nations.</li>
</ul></li>
<li><p><strong>Model Owner</strong></p>
<ul>
<li><p>Sarah Andrews (Deputy Director of Circular Economy Evidence and
Analysis)</p></li>
<li><p>The <strong>model owner</strong> manages the analysts and focuses
on ensuring that the model meets policy goals, including by ensuring
that the modelling team is sufficiently resourced.</p></li>
</ul></li>
<li><p><strong>Fees and Payments Calculator modelling team</strong>
which is made up of</p>
<ul>
<li>G6 head of Fees and Payments Calculator team (Tristan Ibrahim)</li>
<li>G7 lead analysts (Katie Booth and Jacob Billingham) who act as
reviewers, checking the QA log entries of the checkers, but they are
primarily responsible for ensuring that the model is properly designed,
uses adequate data and makes sensible assumptions (“validation” in Aqua
Book terms). They do this by designing validation checks of the model,
and by testing assumptions with knowledgeable stakeholders (those with
consultative roles).</li>
<li>Analysts who act as doers and checkers: produce the model
(writecode, record assumptions) and review each others’ code to check it
is working as described (described as “verification” in the Aqua Book)
in code comments and in the assumptions log. These checks should be
documented in QA logs. These are members of the Government Operational
Research profession, ensuring necessary modelling skills.</li>
</ul></li>
</ul>
</div>
<div id="consultative-roles" class="section level3">
<h3>Consultative Roles</h3>
<p>These are stakeholders who generally have expertise in some area
relevant to the model development. Their advice is used to support
assumptions made in the modelling, and should be recorded in QA logs
with links to evidence such as meeting minutes or email chains.</p>
<p>Regularly consulted stakeholders include:</p>
<ul>
<li><p><strong>Defra legal advisers</strong> – to advise on
interpretation of the (draft) pEPR regulations, which specify what the
model should/may do</p></li>
<li><p><strong>LA payments modelling Technical Working Group
(TWG)</strong> – comprising expert waste advisors to Defra and the
devolved administrations, advising on the adequacy of model
assumptions</p></li>
<li><p><strong>Local authorities (via the LA Waste Officer Sounding
Board)</strong> – selected Waste Officers from local authorities across
the UK to test the validity of assumptions relating to local authority
operations</p></li>
<li><p><strong>Local authorities (via representative bodies, including
bodies for special types of LA such as disposal authorities)</strong> –
such as WIDP, NAWDO, LARAC and more, used similarly to the
above</p></li>
<li><p><strong>Government Actuary’s Department</strong> – to date
external QA, peer review and advice on best practice has been provided
by GAD</p></li>
</ul>
<p>Named individuals correct as of 14/4/2025</p>
</div>
</div>
<div id="approach-to-qa" class="section level2">
<h2>Approach to QA</h2>
<p>In order to ensure the appropriate level of robust QA, we are taking
a multi-layered approach (as recommended by Chart 2.C in the MacPherson
Review and also re-used in the Aqua Book). Below is a list of the steps
taken within this:</p>
<ul>
<li><p>To ensure outputs can be <strong>reproduced</strong>:</p>
<ul>
<li><p>all calculation steps will be scripted, using the R
language;</p></li>
<li><p>model code is version controlled in Github, with a clearly
defined versioning, tagging and publication process;</p></li>
<li><p>data is stored in Amazon S3 and an automated, flexible data
pipeline has been developed to version control this data, ensuring all
versions of the model have access to the correct data.</p></li>
</ul></li>
<li><p>To <strong>verify</strong> the model is error free:</p>
<ul>
<li><p>Github is set to require compulsory code review by a second
analyst before code is merged. This includes a quality assurance
checklist which enforces verification and validation processes are
followed.</p></li>
<li><p>In terms of verification the checklist includes:</p>
<ul>
<li>Ensuring code runs when using an empty R environment, without
error;</li>
<li>Code is efficient, could not be simplified significantly and there
is no redundant code;</li>
<li>Ensuring there are adequate unit tests to guarantee functions are
performing as expected.</li>
</ul></li>
<li><p>We have had versions of the model externally audited by the
Government Actuary’s Department.</p></li>
<li><p>We have appointed a quality assurance lead to monitor and log the
QA activities of the team and ensure they are of sufficient
quality.</p></li>
</ul></li>
<li><p>To <strong>validate</strong> the model works as intended:</p>
<ul>
<li><p>The <em>pull request checklist</em> enforces:</p>
<ul>
<li>Use of our Change log to ensure changes between versions are within
expected bounds;</li>
<li>Use of our Critical Success Factors markdown to ensure the model
meets agreed principles;</li>
<li>Use of our internal validation markdown to ensure outputs resemble
reality.</li>
</ul></li>
<li><p>We have made comparisons of LAPCAP against a second model known
as the top-down model.</p></li>
<li><p>We have tested the modelling approach, model structure, quality
assurance processes, and outputs with our consultative stakeholders as
detailed above.</p></li>
<li><p>We have put in place a formal signoff hierarchy ensuring robust
and appropriate oversight at every stage.</p></li>
</ul></li>
<li><p>To make our analysis simple to <strong>understand</strong> and
<strong>communicate</strong>:</p>
<ul>
<li>The <em>pull request checklist</em> enforces:
<ul>
<li>Code follows the <a href="https://style.tidyverse.org/">Tidyverse
style guide</a>, including comprehensive roxygen headers and
comments;</li>
<li>Maintenance of our technical document, giving model detail that
would be sufficient to replicate the model;</li>
<li>Maintenance of our assumptions logs, alongside the code and in a set
of central logs, covering specifics of assumptions, rationale behind
them and confidence in them;</li>
<li>Maintenance of a log of data, including data quality assessment and
processing done to the data.</li>
</ul></li>
<li>We have converted the model to an R package which guarantees code
documentation is up to standard and makes it easily accessible via the R
Studio IDE.</li>
</ul></li>
</ul>
</div>
<div id="signoff-responsibilities" class="section level2">
<h2>Signoff Responsibilities</h2>
<p>The below provides an outline of who is responsible for signoff of
various pieces of model documentation:</p>
<p><img src="assets/signoff_plan.png" /></p>
<p>For more information, please see <a
href="https://defra.sharepoint.com/:x:/r/teams/Team1478/Extended%20Producer%20Responsibility%20for%20Packaging/07%20Fees%20and%20Payments%20Calculator/18%20Module%20B1%20-%20LA%20FNCs/04%20Bottom-up%20Modelling/00%20Model%20Master/05%20Signoff%20Responsibilities.xlsx?d=w7b7c61c456cb433cafe0bd661ad02b0c&amp;csf=1&amp;web=1&amp;e=HWjPpo">05
Signoff Responsibilities.xlsx</a></p>
</div>
<div id="communication-of-outputs" class="section level2">
<h2>Communication of Outputs</h2>
<p>Once we have a major version of LAPCAP ready for publication this
will be communicated publicly via the following processes.</p>
<ul>
<li><p>Sending of Notification Letters - these give each individual
local authority a breakdown of their payment, with accompanying
explanation, under a number of headings such as collection and disposal
tonnages and costs, as well as split by materials.</p>
<ul>
<li><p>Standard templates have been developed by the PackUK FPC Delivery
team and these have been signed off following their signoff
processes.</p></li>
<li><p>These will then be converted to R markdown documents and
automatically populated, and finally distributed by the digital
team.</p></li>
</ul></li>
<li><p>Publication of Local Authority guidance - a comprehensive local
authority guidance document, giving a full guide to the model will be
published alongside the letters. This differs from the technical guide
in that it will be non-technical, using simple everyday language and
laid out in terms that Local authority waste officers can
understand.</p>
<ul>
<li><p>This will include a ‘worked example’ derived from the example
calculations in the technical document.</p></li>
<li><p>Again these documents have been developed by the PackUK FPC
Delivery team and these have been signed off following their signoff
processes.</p></li>
</ul></li>
<li><p>These publications will be followed up by a webinar at which
local authorities will have the opportunity to pose any further
questions not answered by the previous documents.</p></li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
