<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>LAPCAP Bible</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
  <link rel="icon" type="image/png" href="favicon.ico"/>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="notitle.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">FPC Team Pages</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    New Starters
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="new_induction_stuff.html">Start here!</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">How to...</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="new_how_to_access_r_studio.html">...access R Studio</a>
        </li>
        <li>
          <a href="new_how_to_set_up_github.html">...set up Github</a>
        </li>
        <li>
          <a href="new_how_to_edit_github_code.html">...edit Github code</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li>
  <a href="documentation_library.html">Documentation Library</a>
</li>
<li>
  <a href="lapcap_bible.html">LAPCAP Bible</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Useful Bits
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="other_glossary.html">Glossary</a>
    </li>
    <li>
      <a href="other_learning.html">Learning and Development</a>
    </li>
    <li>
      <a href="other_meeting_etiquette.html">Meeting Etiquette</a>
    </li>
    <li>
      <a href="other_common_problems.html">Common Problems</a>
    </li>
    <li>
      <a href="other_useful_links.html">Collected Links</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">LAPCAP Bible</h1>

</div>


<div id="lapcap-model-development-plan" class="section level1">
<h1>LAPCAP Model Development Plan</h1>
<p>This document is a plan for model development, quality assurance and
signoff processes of LAPCAP. It includes detail on how, when and by whom
model, data or assumption changes will be assured. This includes a list
of responsibilities relating to the model, who the model owner is, the
governance structure and decision-making process supporting the
model.</p>
<p>The below diagrams give an overview of the processes, with more
detail included in later sections.</p>
<div id="coding-process" class="section level3">
<h3>Coding Process</h3>
<p><img src="assets/bible_process_1.png" /></p>
</div>
<div id="signoff-process" class="section level3">
<h3>Signoff Process</h3>
<p><img src="assets/bible_process_2.png" /></p>
</div>
<div id="stakeholder-groups" class="section level3">
<h3>Stakeholder Groups</h3>
<ul>
<li><strong>Senior Responsible Officers (SROs)</strong>
<ul>
<li>Director of Resources &amp; Waste (Emma Bourne) and equivalents in
the Devolved Administrations (David McPhee, Rhodri Asby, Shane
Doris).</li>
</ul></li>
<li><strong>pEPR Project Board</strong>
<ul>
<li>Senior level oversight and support for the delivery of the joint
UK-wide pEPR. Chaired by Dexter Davis.</li>
</ul></li>
<li><strong>Model Owner</strong>
<ul>
<li>G6 head of Fees and Payments Calculator team (Tristan Ibrahim).</li>
</ul></li>
<li><strong>Advisory Groups</strong>
<ul>
<li>Analytical Board - consists of senior analysts from England, Wales
and Scotland</li>
<li>Technical Working Group (TWG) - comprising expert waste advisors to
Defra and the devolved administrations</li>
<li>Local Authority Waste Officer Sounding Board – selected Waste
Officers from local authorities across the UK</li>
<li>Government Actuary’s Department – to date external QA has been
provided by GAD</li>
</ul></li>
<li><strong>Fees and Payments Calculator modelling team</strong>
<ul>
<li>Made up of members of the Government Operational Research
profession, ensuring necessary modelling skills.</li>
</ul></li>
</ul>
<p>Named individuals correct as of 3/2/2025</p>
</div>
</div>
<div id="coding-process-detail" class="section level1">
<h1>Coding Process Detail</h1>
<div id="decide-to-change-code" class="section level2">
<h2>1. Decide to change code</h2>
<p>The modelling team, led by G7s, will identify the most important
changes needed ahead of the next release of modelling outputs.</p>
<p>They may choose to make use of the Analytical Board, TWG or Sounding
Board in determining this.</p>
<p>They may also choose to seek signoff of their plans from the model
owner or project board, or to simply make them aware, to ensure planned
changes are expected.</p>
<p>An agile methodology using Jira is then used to plan out the delivery
of these changes. Time for quality assurance should
<strong>ALWAYS</strong> be built into each ticket in this planning, it
should be understood that if there is not time for quality assurance
then there is not time for the work.</p>
</div>
<div id="make-changes-to-code" class="section level2">
<h2>2. Make changes to code</h2>
<p>Through R Studio and Github changes are made to the existing LAPCAP
model. This will be achieved through standard Git practice,
e.g. branching off from the dev branch. Instructions for how to do this
can be found in the <a href="new_induction_stuff.html">new starter
section</a>.</p>
<p>The changes required should be clearly laid out in the relevant Jira
ticket.</p>
<ol style="list-style-type: lower-alpha">
<li>If the changes involve adding, removing or changing an assumption
then the modelling team member must update the relevant assumption
log:</li>
</ol>
<blockquote>
<h3 id="how_to_assumption">How to change an assumption</h3>
<ol style="list-style-type: decimal">
<li><p>Identify an assumption.</p>
<p>We define assumptions as <strong>“choices analysts make to correct
for low quality or absent data or information, that knowingly introduce
inaccuracy into our outputs.”</strong></p>
<p>Questions to help you determine whether a section of code is an
assumption could be:</p>
<ul>
<li>Have you had to make a specific choice for how to model?</li>
<li>Is your choice a simplification of reality?</li>
<li>Theoretically were there other choices you could have made?</li>
<li>Would changing your choice affect the final number?</li>
<li>Is this information recorded elsewhere (e.g. in a data log or the
technical document)?</li>
</ul></li>
<li><p>Record your assumption in-code</p>
<p>Paste the following code snippet below the relevant portion of code
and edit to reflect the above.</p>
<pre class="r"><code>    # Assumption: Title of assumption
    # RAG: RED 
    # Detailed description 
    # on next line or many. </code></pre>
<p>The title of the assumption should be short, clear and unique to this
assumption.</p>
<p>The RAG rating is a red, amber or green rating summarising both the
quality (e.g. how confident we are) and impact (e.g. how much model
outputs are likely to be affected) of the assumption.</p>
<p>The detail description should give all information needed for someone
to understand the assumption, including why an assumption is needed, why
you have made the choice and more.</p></li>
<li><p>Record your assumption in the relevant assumptions log</p>
<p>Each module has its own assumptions log which you can find via the
Documentation Overview section above.</p>
<p>You will need to fill out the following fields:</p>
<ul>
<li><p>ID <em>- prefilled</em></p></li>
<li><p>Assumption title <em>- same as reported in code</em></p></li>
<li><p>Detailed description <em>- same as reported in code</em></p></li>
<li><p>Reporter <em>- your name</em></p></li>
<li><p>Script(s) <em>- which R script the assumption can be found
in</em></p></li>
<li><p>Line(s) in code <em>- which lines in the script are
relevant</em></p></li>
<li><p>RAG <em>- same as reported in code</em></p></li>
<li><p>RAG explanation <em>- an explanation for why you gave the above
RAG rating</em></p></li>
<li><p>Links to supporting evidence <em>- any supporting evidence that
you used in formulating this assumption, which should be stored in the
corresponding ‘Supporting Evidence’ folder</em></p></li>
</ul></li>
</ol>
</blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>If the changes involve updating a data import then the data pipeline
must be refreshed and data logs updated:</li>
</ol>
<blockquote>
<h3 id="how_to_data_input">How to change a data input</h3>
<p>ANDREW WRITING</p>
<p>Data Pipeline</p>
<ul>
<li><p>The data pipeline should be run to update the data folder prior
to a new version of the model being tagged (ensure to restart your R
session and clean your environment before running the pipeline)</p></li>
<li><p>Before the new version is tagged, you need to change the
model_version parameter in the data pipeline and run it, and change the
model_version parameter in run_LAPCAP_model, then push these changes
before tagging the version</p></li>
<li><p>If you are attempting to overwrite a folder then you will be
asked to confirm – you should be sure that you want to overwrite the
folder as this could prevent rolling back in the future</p></li>
<li><p>Ensure that people are aware of a new version being tagged so
they can rebase if necessary</p></li>
</ul>
<p>Versioning Vx.y.z</p>
<ul>
<li><p>The first number, x, should be updated when figures and published
externally</p></li>
<li><p>The second number, y, should be updated when figures are shared
internally (e.g. Simpler Recycling)</p></li>
<li><p>The third number, z, should be updated when there are changes to
the data or data pipeline</p></li>
<li><p>These versions should be tagged on dev on github to allow easy
rollback to model versions</p></li>
<li><p>When numbers are published externally and the first number
updated, dev should be merged into main</p></li>
</ul>
</blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>If model logic is changed then the technical document, code
comments and roxygen headers must be updated accordingly.</p>
<p>Additionally unit tests may need adding or updating.</p></li>
</ol>
<blockquote>
<h3 id="how-to-update-the-technical-document">How to update the
technical document</h3>
<p>MARCUS TO WRITE?</p>
</blockquote>
<blockquote>
<h3 id="how_to_unit_test">How to write a unit test</h3>
<p>NONO WRITING</p>
</blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>If the changes result in a functional change to the model, i.e. the
changes will effect model outputs, then validation checks must be
carried out.</li>
</ol>
<blockquote>
<h3 id="how_to_validate">How to run validation checks</h3>
<ol style="list-style-type: decimal">
<li><p>Check the percentage difference between the outputs from the last
tagged version of LAPCAP and the output of whatever changes you have
made</p>
<p>Use the spreadsheet “[model_version] model output sensitivity
testing.xlsx” on the Module B1 Sharepoint, within <a
href="https://defra.sharepoint.com/:f:/r/teams/Team1478/Extended%20Producer%20Responsibility%20for%20Packaging/07%20Fees%20and%20Payments%20Calculator/18%20Module%20B1%20-%20LA%20FNCs/04%20Bottom-up%20Modelling/00%20Model%20Master?csf=1&amp;web=1&amp;e=1jREhl">00
Model Master folder</a> &gt; [model_version]</p>
<p>Follow the instructions in the first sheet.</p>
<p>The spreadsheet automatically highlights any percentage changes above
the acceptable threshold. If values become highlighted, make sure to
check with a Grade 7 whether the need for the change justifies the
change in outputs.</p></li>
<li><p>Generate and inspect the Critical Success Factors (CSF) markdown
to ensure the change hasn’t violated any of the success factors</p>
<p>Use the function generate_validation_markdowns() in documents in the
LAPCAP repo to generate the markdown, following the instructions in the
function’s roxygen header</p>
<p>Inspect the output, ensuring that each CSF is still being met. If you
have any concerns, raise them with a G7 or above.</p>
<p>Download a version of the output so you can link it in the pull
request template later.</p></li>
</ol>
</blockquote>
<p>Locations for assumption log, data log or the technical document can
be found in 01 Documentation Overview.docx, and each includes
instructions for how to use it.</p>
<blockquote>
<h3 id="how_to_pull_request">How to make a pull request</h3>
<p>Once the modelling team member has completed their changes, they
should make a pull request and request a review from another member of
the team.</p>
<p>Here are the <strong>step-by-step instructions</strong> to submit a
pull request:</p>
<ol style="list-style-type: decimal">
<li><p>Go to the relevant repo on Github and navigate to your branch</p>
<ol style="list-style-type: lower-alpha">
<li><p>Use either the branches drop down or click on ‘<em>x
branches</em>’ to go to the branches page and select your branch.</p>
<p><img src="assets/branches_button.png" /></p></li>
</ol></li>
<li><p>If your push was recent there may be a pop up allowing you to
‘<em>compare and pull request</em>’, if not then click
‘<em>Contribute</em>’ and ‘<em>Open pull request</em>’.</p>
<p><img src="assets/contribute_button.png" /></p></li>
<li><p>Now check your pull request is set up correctly:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Make sure you are merging to the correct branch, this will
usually be <em>dev</em> (for code in development) or sometimes
<em>main</em> if it has been fully quality assured.</p>
<p><img src="assets/merge_to_dev.png" /></p></li>
<li><p>Fill out the pull request template (following carrying out
validation checks, see below), including adding any additional QA checks
to the list.</p>
<p>Replace this gif with one that describes how you felt about
completing this ticket:</p>
<p><img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExaHB0bHQ4dzQ4anN5b3JoaDIyb2twOXh4Y3U5YWY1NHB6c3dreWdvNSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/gOfSjdLRr6SlvGQTe3/giphy.gif" height="150"/></p>
<p>✔️ <strong>QA checklists</strong></p>
<p>📝 <strong>Description of changes made:</strong></p>
<p>🎟️ <strong>Link to Jira ticket:</strong></p>
<p>🤔 <strong>Link to QA log (assumptions or data log), if
changed:</strong></p>
<p>💾 <strong>If appropriate, link to CSF markdown:</strong></p>
<p>📈 <strong>If appropriate, link to output percentage change
spreadsheet:</strong></p>
<table>
<thead>
<tr class="header">
<th></th>
<th>% change in EPR Total Net Cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Mean absolute change per LA</strong></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Overall</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>England</strong></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Scotland</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Wales</strong></td>
<td></td>
</tr>
<tr class="even">
<td><strong>NI</strong></td>
<td></td>
</tr>
</tbody>
</table>
<p>🌜 <strong>Do-er QA checklist</strong></p>
<p>Before submitting a pull request the principle analyst
<strong>must</strong> have completed the below checks.</p>
<ul class="task-list">
<li><label><input type="checkbox" />Assumptions log has been updated
with any new or changed assumptions, including appropriate rationale
and/or evidence</label></li>
<li><label><input type="checkbox" />Data log has been updated with any
new or changed data</label></li>
<li><label><input type="checkbox" />If functional changes have been made
to code, the CSF markdown has been generated and inspected, and there
are no issues highlighted in visualisations</label></li>
<li><label><input type="checkbox" />If functional changes have been made
to code, the percentage change in model outputs has been calculated and
reported above, if the change is above threshold, this has been raised
with a Grade 7 or above.</label></li>
<li><label><input type="checkbox" />If additional checks are required,
these have been added to the Checker Checklist below, with detailed
instructions as to how to run the checks</label></li>
</ul></li>
<li><p>Click ‘<em>Reviewer</em>’ and select the person who has agreed to
review your code.</p>
<p><img src="assets/reviewers.png" /></p></li>
<li><p>Make sure you have completed the requirements and fill out the
fields in the pull request template.</p></li>
</ol></li>
<li><p>Then you can click ‘<em>Create pull request</em>’.</p>
<ol style="list-style-type: lower-alpha">
<li>Once you have created the pull request you should move the ticket to
‘For Review’ on Jira.</li>
</ol></li>
</ol>
</blockquote>
</div>
<div id="verify-the-changes" class="section level2">
<h2>3. Verify the changes</h2>
<p>Once assigned a review the team member must complete the full
checklist provided by the principle analyst. It is also the QAers must
also review the list critically and ensure that it is both appropriate
and sufficient. If the QAer feels otherwise they must raise this with in
the first instance the principle analyst and then failing this the model
owner.</p>
<p>You should use the checklist below, which is also included in the
pull request template, to ensure you carry out all necessary checks:</p>
<blockquote>
<p>🌛 <strong>Checker QA checklist</strong></p>
<p>Before approving a pull request the reviewer <strong>must</strong>
have completed the below checks: In addition to the above, the following
is a checklist for the reviewer to use:</p>
<ul class="task-list">
<li><p><label><input type="checkbox" />The “do-er” checklist has been
completed to an appropriate standard, fields above the checklist have
been appropriately completed</label></p></li>
<li><p><label><input type="checkbox" />Code meets the requirements set
out in the Jira ticket</label></p></li>
<li><p><label><input type="checkbox" />All functions have roxygen
headers with <span class="citation">@description</span>, <span
class="citation">@param</span> and <span class="citation">@return</span>
fields, and comments in code are appropriate and
sufficient</label></p></li>
<li><p><label><input type="checkbox" />The code runs when using an empty
R environment, without error</label></p></li>
<li><p><label><input type="checkbox" />Code follows the <a
href="https://style.tidyverse.org/">tidyverse</a> and <a
href="https://defra-pepr-modelling-team.github.io/module_b_team_pages/index.html">FPC
style guide</a>.</label></p></li>
<li><p><label><input type="checkbox" />No future risks have introduced
by this change e.g. hardcoded values that may change in the future, or
if they have they are adequately signposted and
justified</label></p></li>
<li><p><label><input type="checkbox" />Code cannot be simplified
significantly, there is no redundancy in code and no changes to model
structure and dependant functions are needed, given the
changes.</label></p></li>
<li><p><label><input type="checkbox" />There are no further improvements
that can be made to the code</label></p></li>
<li><p><label><input type="checkbox" />Any additional QA checks
appropriate to, and sufficient for, the changes have been
performed</label></p></li>
<li><p><label><input type="checkbox" />When submitting the final review,
a comment has been left that summarises the QA checks that have been
performed and the outcomes</label></p></li>
</ul>
</blockquote>
<p>Also you should carry out any additional checks required, which have
been added to the Checker Checklist by the doer.</p>
<p>Reviewers should trace the full logic of the code, both by reading
through it and by running it and spot-checking intermediate data frames.
They should inspect any relevant data imports both in R Studio and
directly from their original source. They should examine model outputs
before and after the changes to ensure they make sense. They should make
sure they are able to replicate any processes or calculations in the
code.</p>
<blockquote>
<p><strong>Additional checks</strong></p>
<p>The below is a list of QA checks that reviewers may want to perform
in addition to the above. Note that this lists is <strong>not
exhaustive</strong> and it is the responsibility of the principle
analyst (do-er) and the QAer (checker) to ensure all items that need to
be checked have been:</p>
<p>1. Check that the calculations done are fit for purpose and are
correct</p>
<p>2. Check that uncertainty has been considered and appropriately
accounted for (e.g. has sensitivity analysis been performed)</p>
<p>3. Check that the data used is fit for purpose and the best option
available to us</p>
<p>4. Check that other appropriate documentation has been completed or
updated to an appropriate standard e.g. the technical document</p>
<p>5. Is the data being correctly pulled into the model?</p>
<p>6. Is the data being properly cleaned and manipulated (either before
the model or during the code)?</p>
<p>7. Has the data been verified and validated? Has it been checked for
potential errors? And has it been confirmed that the data appropriate to
use in the first place? Is it the best possible option?</p>
<p>8. Are there other results other than the outputs of the last model
that the results need to be compared to?</p>
<p>9. In cases where new data is added, or a change is heavily dependent
upon a particular data source, does the model respond as expected to
extreme values, negatives, zeroes, NAs etc? Is it possible to break the
model with the data or generate impossible results?</p>
</blockquote>
<p>Reviewers should leave comments via GitHub, to ensure a record of
verification and validation. GitHub has several features to help with
this such as filtering changes by commit or file type, marking scripts
as viewed, making direct code suggestions and bundling many comments
into one review.</p>
<p>These reviews may go through one or more cycles of requesting
changes, in order for the reviewer to be happy. GitHub has functionality
to enable this.</p>
<p>The following explains the practical steps followed in when reviewing
code:</p>
<blockquote>
<h3 id="how_to_code_review">How to do a code review</h3>
<p>This <a href="https://www.youtube.com/watch?v=lSnbOtw4izI">Github
code review tutorial</a> shows you how to review a pull request, or you
can follow the steps below.</p>
<p>Follow these step-by-step instructions to do a proper code
review:</p>
<ol style="list-style-type: decimal">
<li><p>Navigate to the ‘<em>pull request</em>’ that has been assigned to
you. Read the description provided and use the checklist to aid your
review.</p></li>
<li><p>Switch to the ‘<em>Files changed</em>’ tab to see the changes
made, here you can make comments and suggestions as you see fit by
clicking the blue plus to the left of the line you want to comment
on.</p>
<p><img src="assets/add_comment_button.png" /></p>
<ol style="list-style-type: lower-alpha">
<li>Make sure to tick ‘<em>Start a review</em>’ rather than ‘<em>Add
single comment</em>’.</li>
<li>Github has lots of functionality to make this process easier,
including being able to mark scripts as ‘<em>Viewed</em>’ and limiting
changes to certain commits.</li>
<li>You should also run the code in R Studio and check the relevant QA
log has been updated.</li>
</ol></li>
<li><p>When you are ready click ‘<em>Finish your review</em>’ add a
summary comment and then click ‘<em>Submit review</em>’. You may choose
to leave comments to be responded to, suggest changes to be made or
simply approve the pull request straight away.</p>
<p><img src="assets/finish_review.png" width="311"
height="222" /></p></li>
</ol>
</blockquote>
<p>ADD BIT ABOUT PETER REVIEWING PRs AND RECORDING</p>
</div>
<div id="merge-changes-into-dev-branch" class="section level2">
<h2>4. Merge changes into dev branch</h2>
<p>Once approved, changes should be merged into the dev branch. This may
require resolving merge conflicts.</p>
<blockquote>
<h3 id="how-to-merge">How to merge</h3>
<ol style="list-style-type: decimal">
<li><p>Once your reviewer has inspected your code they may ask you some
questions or suggest some changes. Once you have responded to these they
will approve your pull request and you can merge your changes! This will
look like:</p>
<p><img src="assets/passed_pr_check.png" /></p>
<p><strong>Note</strong>: if any of the QA checklist items have been
left unchecked, GitHub will automatically block merging. It will look
like:</p>
<p><img src="assets/failed_pr_check.png" /></p></li>
<li><p>You will need to check there are no ‘merge conflicts’. This is
where someone has changed the same files as you and so you need to agree
with that person what are the correct changes and modify accordingly,
Github will read ‘<em>Able to merge</em>’ indicating there are no
conflicts.</p>
<p><img src="assets/ready_to_merge.png" /></p></li>
</ol>
</blockquote>
</div>
</div>
<div id="signoff-process-detail" class="section level1">
<h1>Signoff Process Detail</h1>
<div id="model-development-complete" class="section level2">
<h2>1. Model development complete</h2>
<p>Once all changes required for a publication or sharing of the model
are complete, the team will undertake the following steps.</p>
<p>Multiple pull requests will have been merged into dev (e.g. the above
coding process will have been repeated multiple times) and these will
all receive signoff together.</p>
<p>There are some circumstances where the full signoff may not be
required for instance, sharing the model internally, this is left to the
judgment of the model owner.</p>
</div>
<div id="model-owner-signoff" class="section level2">
<h2>2. Model owner signoff</h2>
<p>The model owner should sign off on the following documents, which
should have been updated:</p>
<p>VALIDATION STUFF (PROCESS TBD)</p>
<p>VERIFICATION STUFF (PROCESS TBD)</p>
<p>CHANGE LOG (RENAME)</p>
<p>Technical Document</p>
<p>Assumptions Logs</p>
<p>Data Log (?)</p>
<p>The model owner does not necessarily have to review all of these
themselves; they may utilise the advisory groups to offer assurance. For
instance, in the past TWG have assured on assumptions logs.</p>
<p>The model owner’s signoff for that model version should be stored in
SIGNOFF LOG (EMAIL EVIDENCE).</p>
</div>
<div id="sro-signoff" class="section level2">
<h2>3. SRO signoff</h2>
<p>Project board, acting on behalf of the model SROs, should signoff the
model version for publication.</p>
<p>It is unlikely that members of project board will review any of the
model or its documentation themselves, however copies should be shared
so they have the option to, and can delegate to members of their
organisation.</p>
<p>Instead, summaries of changes, visualisations of overall outputs and
assurances from advisory groups may be presented. Exactly what is
required may depend on the specific changes being signed off, so is left
up to the judgment of the model owner.</p>
<p>There may be an additional stage of parameter setting, at this point
in the approvals process, especially for the first outputs for each new
year of EPR.</p>
<p>The project board signoff for that model version should be stored in
SIGNOFF LOG (MEETING MINUTES AS EVIDENCE?).</p>
</div>
<div id="share-or-publish-outputs" class="section level2">
<h2>4. Share or publish outputs</h2>
<p>Merge into main</p>
<p>Save copy of everything in model master folder</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
